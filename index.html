<!DOCTYPE html>
<html id="home" lang="en">
  <head>
    <meta charset=utf-8 />
    <!-- DataTables CSS -->
<!--     <link rel="stylesheet" type="text/css" href="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/css/jquery.dataTables.css"> -->
    <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.4/css/jquery.dataTables_themeroller.css">
    
    <!-- Theme -->
<!--
    <link rel="stylesheet" type="text/css" href="http://datatables.net/media/css/jui_themes/start/jquery-ui-1.7.2.custom.css">
-->
    <link rel="stylesheet" type="text/css" href="http://datatables.net/media/css/jui_themes/redmond/jquery-ui-1.7.2.custom.css">

    <!-- jQuery -->
    <script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js"></script>
    
    <!-- DataTables -->
    <script type="text/javascript" charset="utf8" src="http://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">

    <!-- Optional theme -->
<!--     <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css"> -->

    <!-- Latest compiled and minified JavaScript -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>

    <script type="text/javascript" charset="utf8">
      $(document).ready(function(){
        // read data from GitHub
        //var toolsUrl = "http://raw.github.com/bpmn-miwg/bpmn-miwg-test-suite/master/tools-tested-by-miwg.json";
//         var toolsUrl = "https://api.github.com/repos/bpmn-miwg/bpmn-miwg-test-suite/contents/tools-tested-by-miwg.json"; // application/vnd.github.v3.raw
//         var toolsUrl = "../../bpmn-miwg-test-suite/tools-tested-by-miwg.json";
        var toolsUrl = "tools-tested-by-miwg.json";
        var openIssuesUrl = "issues-open.json";
        var closedIssuesUrl = "issues-closed.json";

        $.getJSON(toolsUrl, function (toolsTestedByMIWG) {
          $.getJSON(openIssuesUrl, function (openIssues) {
            $.getJSON(closedIssuesUrl, function (closedIssues) {

              for (i = 0; i < toolsTestedByMIWG.tools.length; i++) {
                toolsTestedByMIWG.tools[i].openIssues = 0;
                toolsTestedByMIWG.tools[i].closedIssues = 0;
                openIssues.forEach(function(issue) {
                  issue.labels.forEach(function(label) {
                    if (label.name == 'Tool: ' + toolsTestedByMIWG.tools[i].tool) {
                      toolsTestedByMIWG.tools[i].openIssues++;
                    }
                  });
                });
                closedIssues.forEach(function(issue) {
                  issue.labels.forEach(function(label) {
                    if (label.name == 'Tool: ' + toolsTestedByMIWG.tools[i].tool) {
                      toolsTestedByMIWG.tools[i].closedIssues++;
                    }
                  });
                });
              }

              $('#bpmn-tools').dataTable( {
                "bJQueryUI": true,
                "bPaginate": false,
      //          "sAjaxSource": "http://open.dapper.net/transform.php?dappName=BPMNToolsfromBPMNorg&transformer=JSON&applyToUrl=http%3A%2F%2Fwww.businessprocessincubator.com%2Ftag%2Fproduct%2Flist%2FtagId%2F170%2F%3Fbpi-embedded%3D1%26bpi-feed%3D1%26dir%3Dasc%26layout%5B0%5D%3Dnew-window%26limit%3Dall%26mode%3Dgrid%26order%3Dname%26utm_campaign%3DFeed%26utm_medium%3Dweb%26utm_source%3DOMG",
      //          "sAjaxSource": toolsUrl,
      //          "sAjaxDataProp": "tools",
                "aaData": toolsTestedByMIWG.tools,
                "aaSorting": [[ 2, "desc" ], [ 6, "desc" ], [ 5, "desc" ], [ 4, "desc" ], [ 3, "desc" ], [ 7, "desc" ], [ 8, "desc" ], [ 9, "asc" ], [10, "desc" ], [0, "asc" ], [1, "asc" ]],
                "aoColumns": [
                    { "mData": "vendor" },
                    { "mData": "tool",
                      "mRender": function ( data, type, full ) {
                        var result = '';
                        if (full.website.length == 0) {
                          result = data.replace('Microsoft', 'MS')+' '+full.version;
                        } else {
                          result = '<a href="'+full.website+'">'+data.replace('Microsoft', 'MS')+' '+full.version.replace('c906a7c941b82dbb832ed9be62989c171c724199', 'c906a7c941')+'</a>';
                        }
                        return '<strong>' + result + '</strong>';
                      } },
                    { "mData": "supportsBpmn2", "mRender": renderBoolean },
                    { "mData": "hasImport", "mRender": renderImportExport },
                    { "mData": "hasExport", "mRender": renderImportExport },
                    { "mData": "hasRoundtrip", "mRender": renderBoolean },
                    { "mData": "testResultsSubmitted", "mRender": renderTestResultsSubmitted },
                    { "mData": "participatedInDemos", "mRender": renderBoolean },
                    { "mData": "openSource", "mRender": renderLicense },
                    { "mData": "openIssues",
                      "mRender": function ( data, type, full ) {
                        return '<a href="https://github.com/bpmn-miwg/bpmn-miwg-test-suite/issues?state=open&labels=Tool%3A+' + full.tool.replace(/\+/g, '%2b').replace(/ /g, '+') + '"><strong>' + data + '</strong></a>';
                      } },
                    { "mData": "closedIssues",
                      "mRender": function ( data, type, full ) {
                        return '<a href="https://github.com/bpmn-miwg/bpmn-miwg-test-suite/issues?state=closed&labels=Tool%3A+' + full.tool.replace(/\+/g, '%2b').replace(/ /g, '+') + '"><strong>' + data + '</strong></a>';
                      } },
      //               { "mData": "notes" },
                ],
              } );

              function renderImportExport(data, type, full) {
                var result = renderBoolean(data, type, full);
                if ((data === true) && (full.testResultsSubmitted === true || full.testResultsSubmitted === "partial")) {
                  var toolAndVersion = encodeURIComponent(full.tool + ' ' + full.version);
                  // TODO trying to figure out why Firefox does not 
                  // show the anchor encoded as expected
                  console.debug('toolAndVersion:'+toolAndVersion);
                  result = '<span class="sr-only">' + data + '</span><a href="visual-test-result-comparison.html?tool=' + toolAndVersion + '">' + result + ' Diff</a>';
                }
                return result;
              }

              function renderTestResultsSubmitted(data, type, full) {
                var result = renderTrafficLight(data, type, full);
                if ((data === true || data === "partial") && (full.hasExport === true || full.hasRoundtrip === true)) {
                  var toolAndVersion = encodeURIComponent(full.tool + ' ' + full.version);
                  // TODO trying to figure out why Firefox does not 
                  // show the anchor encoded as expected
                  console.debug('toolAndVersion:'+toolAndVersion);
                  result = result
                    + ' <a href="overview.html#' + toolAndVersion + '">Details</a>'
                }
                return result;
              }

              function renderLicense(data, type, full) {
                if (data) {
                  return 'Open&nbsp;Source';
                } else {
                  return 'Commercial';
                }
              }

              function renderTrafficLight(data, type, full) {
                var icon = "minus-sign"; // ban-circle remove-sign
                var color = "darkred";
                if (data === true) {
                  icon = "plus-sign"; // ok-sign
                  color = "green";
                } else if (data === "partial") {
                  icon = "adjust";
                  color = "darkorange";
                }
                return renderIcon(icon, color, data);
              }

              function renderBoolean(data, type, full) {
                var icon = "minus-sign"; // remove
                var color = "darkred";
                if (data) {
                  icon = "plus-sign"; // ok
                  color = "green";
                }
                return renderIcon(icon, color, data);
              }

              function renderIcon(icon, color, data) {
                return '<span class="glyphicon glyphicon-' + icon + '" style="color: ' + color + '"></span><span class="sr-only">' + data + '</span>';
              }

            })
          })
        })
                    
        $('.panel[id="legend"] .panel-title').prepend('<span class="toggle-indicator btn btn-default">+</span>&nbsp;');
        $('.panel[id="legend"] .panel-heading').click(function(panel) {
          // TODO this hardcoding of index 0 will always operate on legend panel
          togglePanel('#'+$($('.panel-heading')[0]).parent()[0].id);
        });
      });
                    
      function togglePanel(selector) { 
        console.log('toggling panel: '+selector);
        if ($(selector+' .panel-body').css('display')=='none') {
          $(selector+' .toggle-indicator').empty().append('-');
        } else { 
          $(selector+' .toggle-indicator').empty().append('+');
        }
        $(selector+' .panel-body').toggle(); 
      } 
    </script>
  </head>
  <body>
    <h1><img style="margin: 0 15px;" src="http://omgwiki.org/bpmn-miwg/lib/exe/fetch.php?w=200&amp;media=miwg-logo-827x512.png" class="mediacenter" alt="" width="200">BPMN Tools tested for Model Interchange</h1>
    <div style="padding: 0 15px;">
      <table id="bpmn-tools" class="display" width="100%">
        <thead>
          <tr>
            <th width="25%">Vendor</th>
            <th width="25%">Tool Name &amp; Version</th>
            <th>BPMN 2.0</th>
            <th>Import</th>
            <th>Export</th>
            <th>Roundtrip</th>
            <th>Results Submitted</th>
            <th>Part of Demos</th>
            <th>License</th>
            <th>Open Issues</th>
            <th>Closed Issues</th>
<!--             <th>Notes</th> -->
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
      <br />
      <div class="panel panel-default" id='legend'>
        <div class="panel-heading">
          <h3 class="panel-title">Legend</h3>
        </div>
        <div class="panel-body" style="display:none">
          <table class="table">
            <thead>
              <tr>
                <th>Column</th>
                <th>Definition</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Vendor</td>
                <td>Company that develops the tool</td>
              </tr>
              <tr>
                <td>Tool Name &amp; Version</td>
                <td>Product name of the tool and version that has been tested</td>
              </tr>
              <tr>
                <td>BPMN 2.0</td>
                <td>Tool supports BPMN version 2.0 or higher</td>
              </tr>
              <tr>
                <td>Import</td>
                <td>Tool has a feature to import BPMN 2.0 XML files based on the XML Schema Definition (XSD) that ships with the specification</td>
              </tr>
              <tr>
                <td>Export</td>
                <td>Tool has a feature to export BPMN 2.0 XML files based on the XML Schema Definition (XSD) that ships with the specification</td>
              </tr>
              <tr>
                <td>Roundtrip</td>
                <td>Tool can both import and export BPMN 2.0 XML files based on the XML Schema Definition (XSD) that ships with the specification</td>
              </tr>
              <tr>
                <td>Results submitted</td>
                <td>Test results have been submitted for the tool either by users or the vendor (<span class="glyphicon glyphicon-plus-sign" style="color: darkgreen"></span> complete, <span class="glyphicon glyphicon-adjust" style="color: darkorange"></span> partial, <span class="glyphicon glyphicon-minus-sign" style="color: darkred"></span> none)</td>
              </tr>
              <tr>
                <td>Part of Demos</td>
                <td>Tool participated in one of the <a href="https://github.com/bpmn-miwg/bpmn-miwg-demos">public BPMN MIWG demos</a></td>
              </tr>
              <tr>
                <td>License</td>
                <td>License of the tool</td>
              </tr>
              <tr>
                <td>Open Issues</td>
                <td>Issues identified by the BPMN MIWG that are still open (click on the number to see the issues)</td>
              </tr>
              <tr>
                <td>Closed Issues</td>
                <td>Issues identified by the BPMN MIWG that are already fixed by the vendor (click on the number to see the issues)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="panel panel-primary" id='callForParticipation'>
        <div class="panel-heading">
          <h3 class="panel-title"><strong>Call for Participation</strong></h3>
        </div>
        <div class="panel-body">
          <p>If BPMN interchange is important to you: </p>
          <ul>
           <li><strong><a href="https://github.com/bpmn-miwg/bpmn-miwg-test-suite#how-to-test-a-bpmn-tool-using-this-test-suite">Test your favorite BPMN tool!</a></strong> Also users can submit test results. You don't need to be the author of a tool to use it.</li>
           <li><strong><a href="http://www.omgwiki.org/bpmn-miwg/doku.php#requirements_of_participation_and_how_to_join">Join the Group!</a></strong> Everybody can join. There is no need to be an OMG member. Get in touch with the people behind the standards.</li>
           <li>Make yourself heard with your vendor.</li>
           <li>Spread the word and share this page with your peers.</li>
          </ul>
        </div>
      </div>
        
      <div class="panel panel-default" id='contributors'>
        <div class="panel-heading">
          <h3 class="panel-title">Contributors</h3>
        </div>
        <div class="panel-body">
          <p>
            The <a href="https://github.com/bpmn-miwg/bpmn-miwg-tools">MIWG test tools</a> have been built by:   
          </p>
          <div class="row">
            <div class="col-xs-6 col-sm-6 col-md-3" style="margin-top:10px;">
              <a href="http://www.camunda.com" target="_newtab">
                <img alt="camunda" class="img-thumbnail" src="img/camunda.png" style="height: 90px" />
              </a>
            </div>
            <div class="col-xs-6 col-sm-6 col-md-3" style="margin-top:10px;">
              <a href="http://www.knowprocess.com" target="_newtab">
                <img alt="Know Process" class="img-thumbnail" src="img/knowprocess.png"/>
              </a>
            </div>
            <div class="col-xs-6 col-sm-6 col-md-3" style="margin-top:10px;">
              <p style="margin-top: 26px;font-size: 20px;font-weight: bold;text-align: center;">Matthias Kurz</p>
            </div>
            <div class="col-xs-6 col-sm-6 col-md-3" style="margin-top:10px;">
              <a href="http://www.signavio.com" target="_newtab">
                <img alt="Signavio" class="img-thumbnail" src="img/Signavio.jpg" style="height: 90px" />
              </a>
            </div>
          </div>
        </div>
      </div>
        
      <p>Powered by <a href="http://datatables.net/">jQuery DataTables</a>, <a href="http://getbootstrap.com/">Bootstrap</a> and <a href="http://open.dapper.net/">Dapper</a></p>
    </div>
  </body>
</html>
